<div id="edit-section">

  <div id="contribute-title">
    <h1>Contribute</h1>
  </div>

  <form [formGroup]="form" (ngSubmit)="onSubmit()" (keydown.enter)="handleEnter($event)">


    <!-- Select type of contribution -->
    <mat-radio-group aria-label="What would you like to add?" formControlName="type" id="resource-type-selector-container">

      <div id="resource-type-selector-header">
        <mat-label>Which type of contribution would you like to make?</mat-label>
        <button mat-icon-button
          color="primary"
          matTooltip="What does this mean?"
          matTooltipPosition="after"
          (click)="openTypeDialog()"
          type="button"
        >
          <mat-icon>information</mat-icon>
        </button>
      </div>


      <mat-radio-button value="topic" class="resource-type-selector">Topic</mat-radio-button>
      <mat-radio-button value="resource" class="resource-type-selector">Resource</mat-radio-button>

    </mat-radio-group>


    <!-- If resource, show dropdown of topics to which they  -->
    <!-- If topic, show input field for topic name -->
    <div id="type-option-container">

      <mat-form-field *ngIf="form.get('type').value === 'topic'" id="topic-input">
        <input matInput type="text" placeholder="Topic name" formControlName="topicTitle">
      </mat-form-field>

      <mat-form-field *ngIf="form.get('type').value === 'resource'" id="topic-selector">

        <mat-label>Pick a topic</mat-label>

        <mat-select formControlName="topic">
          <mat-option *ngFor="let topic of topics$ | async" [value]="topic">{{ topic }}</mat-option>
        </mat-select>

      </mat-form-field>

    </div>


    <!-- Show editor -->
    <div id="editor-wrapper">
      <quill-editor #editor formControlName="editor" id="quill-editor" theme="snow"></quill-editor>
      <div id="editor-wordcount" [ngClass]="{'invalid-count': (wordcount < 20 || wordcount > 1000) && wordcount > 0}">{{ wordcount }}/1000</div>
    </div>


    <!-- Source list -->
    <div id="source-list-container">

      <div class="source-list-item" *ngFor="let source of sources; let i = index">
        <span class="source-content" [matTooltip]="source">{{ source | contributionUrl }}</span>
        <div
          class="material-icons source-remove-btn"
          matTooltip="Remove source"
          (click)="onRemoveSource(i)"
          >close</div>
      </div>
    </div>

    <!-- Add source input -->
    <div id="add-source-container">
      <mat-form-field id="source-url-field">
        <input matInput placeholder="Source URL" formControlName="sourceInput" (keydown.enter)="onAddSource()">
        <mat-hint (click)="openSourceDialog()" id="source-info-hint">Why do we ask for sources?</mat-hint>
      </mat-form-field>

      <button
        mat-stroked-button
        color="primary"
        type="button"
        [disabled]="form.get('sourceInput').value === '' || !form.get('sourceInput').valid || !form.get('sourceInput').dirty"
        (click)="onAddSource()"
      >Add source</button>
    </div>

    <!-- Submit form -->
    <button mat-raised-button color="primary" type="submit" id="submit-btn" [disabled]="!form.valid || sources.length < 1">SUBMIT {{ form.get('type').value | uppercase }}</button>

  </form>

</div>
